
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Fitting noisy data revisited &#8212; Computational Physics U24568</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lecture 11b: Using Cython to get the speed of C in Python" href="../11b/overview.html" />
    <link rel="prev" title="The Goldfish Bowl" href="CompPhys_Lect11a_1_TheGoldfishBowl.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Physics U24568</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01a/overview.html">
   Lecture 1a - Introduction and recap
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01a/CompPhys_Lect01a_02_Expressions_Datatypes_Errors.html">
     Expressions, data types and Errors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01a/CompPhys_Lect01a_03_Loops_Conditionals.html">
     Loops, Lists and Conditionals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01a/CompPhys_Lect01a_04_Functions.html">
     Writing functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01a/CompPhys_Lect01a_05_Numpy.html">
     Numpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01a/CompPhys_Lect01a_06_Plotting.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01b/overview.html">
   Lecture 1b - Problem solving (in python)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01b/CompPhys_Lect01b_02_Problem_A.html">
     Problem A
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01b/CompPhys_Lect01b_03_Problem_B.html">
     Problem B
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01b/CompPhys_Lect01b_04_Problem_C.html">
     Problem C
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01b/CompPhys_Lect01b_05_Problem_D.html">
     Problem D - challenging
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02a/overview.html">
   Lecture 2a - Advanced Numpy and Data Manipulation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02a/CompPhys_Lect02a_01_Review.html">
     Review
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02a/CompPhys_Lect02a_02_BooleanIndexing.html">
     Boolean indexing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02a/CompPhys_Lect02a_03_NumpyMethods.html">
     Methods of numpy arrays.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02a/CompPhys_Lect02a_04_NumpyMatrices.html">
     Matrices in numpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02a/CompPhys_Lect02a_05_NumpyPandasIO.html">
     Saving data in numpy/pandas - a recap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02a/CompPhys_Lect02a_06_Summary.html">
     Final exercise and summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02b/overview.html">
   Lecture 2b - Statistics I
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02b/CompPhys_Lect02b_01_Distributions.html">
     Statistical distributions and python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02b/CompPhys_Lect02b_02_MoreStatistics.html">
     Acronyms and more exploration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02b/CompPhys_Lect02b_03_Challenge.html">
     Data challenge…
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03a/overview.html">
   Lecture 3a - Statistics II
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03a/CompPhys_Lect03a_01_GeneratingData.html">
     Generating mock data by drawing from distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03a/CompPhys_Lect03a_02_ComputingPi.html">
     Calculating pi by Monte Carlo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03a/CompPhys_Lect03a_03_WhatIsNoise.html">
     What is noise?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03b/overview.html">
   Lecture 3b: Class Conundrums
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03b/Introduction.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03b/Initializing_a_class.html">
     Initializing a class
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03b/Initializing_a_class_exercise.html">
     EXERCISE - Initializing a class
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03b/Optional_arguments.html">
     Optional arguments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03b/Class_defining_practice.html">
     EXERCISES - Practicing defining classes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03b/Attributes_and_inheritance.html">
     Class attributes and inheritence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03b/Attributes_and_inheritance_exercise.html">
     EXERCISE: Class attributes and inheritence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03b/Recap.html">
     Recap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03b/Summary_exercises.html">
     SUMMARY EXERCISES
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03b/Acknowledgements.html">
     Acknowledgements
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../04a/overview.html">
   Lecture 4a: Advanced Techniques
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../04a/Introduction.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04a/List_comprehensions_overview.html">
     List comprehensions - Overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04a/List_comprehensions_exercises1.html">
     List comprehensions - Exercises 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04a/List_comprehensions_conditionals.html">
     List Comprehensions - Including conditionals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04a/List_comprehensions_exercises2.html">
     List Comprehensions - Exercises 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04a/Set_dictionary_comprehensions.html">
     Set and Dictionary Comprehensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04a/Generators_overview.html">
     Generators - Overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04a/Generators_exercises1.html">
     Generators - Exercises 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04a/Generators_more_detail.html">
     Generators - A bit more complexity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04a/Generators_exercises2.html">
     Generators - Exercises 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04a/Recursion_overview.html">
     Recursion - Overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04a/Recursion_exercises.html">
     Recursion - Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04a/Lambda_overview.html">
     Function as a value and the lambda operator - Overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04a/Lambda_exercises.html">
     Function as a value and the lambda operator - Exercise
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04a/Summary_exercises.html">
     Summary Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../04b/overview.html">
   Lecture 4a: Data Cleaning
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../04b/CompPhys_Lect04b_01_DataCleaning.html">
     Reading and Cleaning Data with Pandas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05a/overview.html">
   Lecture 5a: Ordinary differential equations I
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05a/CompPhys_Lect05a_01_EulerMethod.html">
     The Euler Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05a/CompPhys_Lect05a_02_DecayingExponential.html">
     The Decaying Exponential
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05a/CompPhys_Lect05a_03_Sinusoid.html">
     The Sinusoid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05a/CompPhys_Lect05a_04_CoupledEquations.html">
     Coupled Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05a/CompPhys_Lect05a_05_NonlinearEquation.html">
     Nonlinear Equation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05b/overview.html">
   Lecture 5b: Ordinary differential equations II
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05b/CompPhys_Lect05b_01_Gravity.html">
     Gravity!
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05b/CompPhys_Lect05b_02_Earth.html">
     Earth’s Orbit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05b/CompPhys_Lect05b_03_MarsMission.html">
     Mission to Mars
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05b/CompPhys_Lect05b_04_BlackHoleMergers.html">
     Merging black holes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05b/CompPhys_Lect05b_05_Challenges.html">
     Challenges
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../06a/overview.html">
   Lecture 6a: Ordinary differential equations III - N-body simulations and more
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../06a/CompPhys_Lect06a_01_NBody.html">
     N-body Simulations and More
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../06b/overview.html">
   Lecture 6b: Fancy plots (or something)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../06b/CompPhys_Lect06b_01_PlottingPlotly.html">
     Fancy plots in plotly
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../07a/overview.html">
   Lecture 7a: CW1 review
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../07a/CompPhys_Lect07a_01_Review.html">
     Review and example assessment questions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07b/overview.html">
   Lecture 7b: LaTeX
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../08a/overview.html">
   Lecture 8a: Signal processing 1, Discrete Fourier Transforms
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../08a/DFT_overview.html">
     Discrete Fourier Transforms - What is a Fourier transform?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08a/DFT_coding_help.html">
     Discrete Fourier Transforms - What we need to remember for coding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08a/DFT_Coding_Easy.html">
     Coding up a Fourier transform - EASY(IER) VERSION
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08a/DFT_coding_hard.html">
     Coding up a Fourier transform - HARD VERSION
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08a/DFT_more_exercises.html">
     Discrete Fourier Transforms - Further Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08a/DFT_summary.html">
     Discrete Fourier Transforms - SUMMARY
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08a/Aliasing_introduction.html">
     Aliasing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08a/Aliasing_exercises.html">
     Aliasing exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08a/Aliasing_summary.html">
     Aliasing Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../08b/overview.html">
   Lecture 8ab: Signal processing 2, Manipulating data in the frequency domain
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../08b/CompPhys_Lect08b_01_NaiveHighPassFilter.html">
     A naive implementation of a high-pass filter.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08b/CompPhys_Lect08b_02_BetterHighPassFilter.html">
     An improved implementation of a high-pass filter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08b/CompPhys_Lect08b_03_LongConvolutionExample.html">
     A long example of applying a high-pass filter through convolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08b/CompPhys_Lect08b_04_Scipy.html">
     High pass filtering with scipy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08b/CompPhys_Lect08b_05_Exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../09a/overview.html">
   Lecture 9a: Signal processing 3, Cross-correlation, convolution and matched-filtering
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../09a/CompPhys_Lect09a_01_CrossCorrelation1.html">
     Cross-correlation to find a known signal in noise
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09a/CompPhys_Lect09a_02_CrossCorrelationExercises.html">
     Cross correlation exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09a/CompPhys_Lect09a_03_FreqDomainCrossCorrelation.html">
     Using Fourier transforms to do cross-correlation quicker (convolution)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09a/CompPhys_Lect09a_04_SignalExercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../09b/overview.html">
   Lecture 9b: Code Optimization in Python (I)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../09b/introduction.html">
     Techniques to profile and optimise python code - I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09b/installing_profilers.html">
     Importing necessary backends
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09b/optimization_example.html">
     A long(ish) example showing how to optimize a numerical integration code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09b/optimization_exercises.html">
     Some code optimization exercises - Removing for loops!
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09b/square_digits_opt.html">
     Interactive example of non numpy-able code optimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09b/using_the_right_tool.html">
     Identifying common elements in two large lists
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09b/sort_function.html">
     Writing a function to sort an array
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09b/example_sort_functions.html">
     Some sort methods to compare against
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09b/acknowledgements.html">
     Acknowledgements
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../10a/overview.html">
   Lecture 10a: Monte Carlo techniques
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../10a/CompPhys_Lect10a_01_CalculatingG.html">
     Calculating g with errors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10a/CompPhys_Lect10a_02_BeatTheCasino.html">
     Beat the casino!
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10a/CompPhys_Lect10a_03_ParameterUncertainties.html">
     Parameter Uncertainty
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../10b/overview.html">
   Lecture 10b: Significance
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../10b/CompPhys_Lect10b_1_ExerciseOne.html">
     Significance exercise 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10b/CompPhys_Lect10b_2_ExerciseTwo.html">
     Significance Exercise 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="overview.html">
   Lecture 11a: Markov Chain Monte Carlo
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="CompPhys_Lect11a_1_TheGoldfishBowl.html">
     The Goldfish Bowl
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Fitting noisy data revisited
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../11b/overview.html">
   Lecture 11b: Using Cython to get the speed of C in Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
  <label for="toctree-checkbox-21">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../11b/CompPhys_Lect11b_1_CythonDemonstration.html">
     Cython demonstrated
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11b/CompPhys_Lect11b_2_CythonDemonstration2.html">
     A longer Cython example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11b/CompPhys_Lect11b_3_Examples1.html">
     Exercise Set 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11b/CompPhys_Lect11b_4_Examples2.html">
     Exercise Set 2
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/icg-gravwaves/U24568_Computational_Physics/main?urlpath=lab/tree/11a/CompPhys_Lect11a_2_NoisyDataFittingRevisited.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/icg-gravwaves/U24568_Computational_Physics/blob/main/11a/CompPhys_Lect11a_2_NoisyDataFittingRevisited.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/icg-gravwaves/U24568_Computational_Physics"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/icg-gravwaves/U24568_Computational_Physics/issues/new?title=Issue%20on%20page%20%2F11a/CompPhys_Lect11a_2_NoisyDataFittingRevisited.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/11a/CompPhys_Lect11a_2_NoisyDataFittingRevisited.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bayes-theorem">
   Bayes Theorem
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-likelihood">
     The likelihood
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise">
       EXERCISE:
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-prior">
     The prior
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-evidence">
     The evidence
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-posterior">
     The posterior
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recipe-for-mcmc-using-metropolis-hastings-algorithm">
   Recipe for MCMC using metropolis hastings algorithm
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     EXERCISE
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fitting-the-data">
   Fitting the data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Exercise
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Fitting noisy data revisited</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bayes-theorem">
   Bayes Theorem
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-likelihood">
     The likelihood
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise">
       EXERCISE:
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-prior">
     The prior
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-evidence">
     The evidence
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-posterior">
     The posterior
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recipe-for-mcmc-using-metropolis-hastings-algorithm">
   Recipe for MCMC using metropolis hastings algorithm
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     EXERCISE
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fitting-the-data">
   Fitting the data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Exercise
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="fitting-noisy-data-revisited">
<h1>Fitting noisy data revisited<a class="headerlink" href="#fitting-noisy-data-revisited" title="Permalink to this headline">#</a></h1>
<p>Thinking back to the notebook 10a, where we fitted a straight line model to date. Here, let’s use MCMC to fit the data</p>
<p>A reminder of what our data looks like: (Copied from notebook 10a)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">corner</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setting a seed - what does this do?</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="c1"># The &quot;true&quot; parameters.</span>
<span class="n">m_true</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.9</span>
<span class="n">b_true</span> <span class="o">=</span> <span class="mf">4.0</span>
<span class="n">f_true</span> <span class="o">=</span> <span class="mf">0.9</span> 

<span class="c1"># Generate some synthetic data from the model.</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">35</span> <span class="c1"># number of data points to generate</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">))</span> <span class="c1"># randomly generate x</span>
<span class="n">yerr</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="c1"># randomy generate yerr</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">m_true</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b_true</span> <span class="c1"># y = m*x + b</span>
<span class="n">y</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">f_true</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">y</span> <span class="o">+=</span> <span class="n">yerr</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="c1"># plotting this data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">yerr</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.k&quot;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Our data&#39;</span><span class="p">)</span>

<span class="c1"># plotting the model we drew the mock data from</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">m_true</span> <span class="o">*</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">b_true</span><span class="p">,</span> <span class="s2">&quot;r--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True model&#39;</span><span class="p">)</span>

<span class="c1"># Always remember to apropriately label your plots!</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;y&#39;)
</pre></div>
</div>
<img alt="../_images/CompPhys_Lect11a_2_NoisyDataFittingRevisited_4_1.png" src="../_images/CompPhys_Lect11a_2_NoisyDataFittingRevisited_4_1.png" />
</div>
</div>
<section id="bayes-theorem">
<h2>Bayes Theorem<a class="headerlink" href="#bayes-theorem" title="Permalink to this headline">#</a></h2>
<p>You may have come across Bayes theorem below (think school, venn diagrams and rearranging formulae for conditional probability - if you haven’t / don’t remember it, wikipedia it!):</p>
<div class="math notranslate nohighlight">
\[P(A|B) = \frac{P(A)P(B|A)}{P(B)}\]</div>
<p>Changing A and B into things we care about:</p>
<div class="math notranslate nohighlight">
\[P(model | data) = \frac{P(model)P(data | model)}{P(data)}\]</div>
<p>The names assigned to the parts of the equations are this:</p>
<div class="math notranslate nohighlight">
\[Posterior = \frac{Prior~\times~Likelihood}{Evidence}\]</div>
<p>We usually want to know what is the probability that our model is correct given the data - this is what is on the left hand side. It’s name is the ‘posterior’ distribution.</p>
<p>But this can be hard to find…why?</p>
<p>Well… <span class="math notranslate nohighlight">\(P(model)\)</span> (called the prior) is easy: this is just the prior information we are choosing to include.</p>
<p><span class="math notranslate nohighlight">\(P(data | model)\)</span> (called the likelihood) is usually not too hard to get the shape of the distribution. However, if we are doing this naively and evaluating the data given the model on a full grid of all possible parameters it might take forever! For example, if we have a 5 parameter model and we were to evaluate the likelihood at each of 10 values we will already have <span class="math notranslate nohighlight">\(10^{5}\)</span> grid points!</p>
<p>But <span class="math notranslate nohighlight">\(P(data)\)</span> (the evidence) is usually pretty difficult! To calculate <span class="math notranslate nohighlight">\(P(data)\)</span> you need to have the <span class="math notranslate nohighlight">\(P(data | \textit{every hypothesis})\)</span>, this could take infinite values depending on your situation. But <span class="math notranslate nohighlight">\(P(data)\)</span> doesn’t depend on the model parameters itself. So if we can work out the shape of the final distribution we could then sample from it and use our samples to work out the probabilities.</p>
<p>MCMC provides us a way to sample from the distribution by creating a chain where the ‘stationary’ or equilibrium distribution is the same shape as the posterior distribution, but we don’t need to know the exact height of this distribution.</p>
<p>The goal is to construct a sequence which walks around in such a way that the chain itself will have the desired stationary distribution.</p>
<p>One algorithm is the <span class="math notranslate nohighlight">\(\textit{metropolis hastings}\)</span> algorithm. Let’s code it up ourselves and refit our line from the start.</p>
<p>But first let’s write some functions which will allow us to calculate the likelihood and prior.</p>
<section id="the-likelihood">
<h3>The likelihood<a class="headerlink" href="#the-likelihood" title="Permalink to this headline">#</a></h3>
<p>Our model is below. Let’s assume this is a good model and use MCMC to find the uncertainty on the parameters.
$<span class="math notranslate nohighlight">\(y = mx+b\)</span>$</p>
<p>with variance <span class="math notranslate nohighlight">\(s_n^2\)</span></p>
<div class="math notranslate nohighlight">
\[
    s_n^2 = \sigma_n^2+f^2\,(m\,x_n+b)^2 \quad .
\]</div>
<p>This likelihood function is simply a Gaussian where the variance is
underestimated by some fractional amount,  <span class="math notranslate nohighlight">\(f\)</span></p>
<p>The linear least squares method used before in the basic MC example assumed the error bars are correct, Gaussian and independent.</p>
<p>We know this is not the case as we set up the model. (Remember we said there was additional intrinsic scatter denoted by <span class="math notranslate nohighlight">\(f\)</span>).</p>
<p>Unfortunately, there isn’t a generalisation of least squares that supports a model like the one that we know to be true.</p>
<p>We can instead write down the log (<em>natural log</em>) likelihood function and numerically maximise it. (We use the log simply because products in log are sums and that makes life easier)</p>
<p>In mathematical notation, the correct log likelihood function is:</p>
<div class="math notranslate nohighlight">
\[
    \ln\,p(y\,|\,x,\sigma,m,b,f) =
    -\frac{1}{2} \sum_n \left[
        \frac{(y_n-m\,x_n-b)^2}{s_n^2}
        + \ln \left ( 2\pi\,s_n^2 \right )
    \right]
\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[
    s_n^2 = \sigma_n^2+f^2\,(m\,x_n+b)^2 \quad .
\]</div>
<p>This likelihood function is simply a Gaussian where the variance is
underestimated by some fractional amount:  <span class="math notranslate nohighlight">\(f\)</span>.</p>
<section id="exercise">
<h4>EXERCISE:<a class="headerlink" href="#exercise" title="Permalink to this headline">#</a></h4>
<p>I have written the equation in python below but there are 4 bugs - find them!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">log_likelihood</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="p">):</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">log_f</span> <span class="o">=</span> <span class="n">theta</span> <span class="c1"># theta contains our parameters to infer</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">m</span> <span class="o">**</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span> <span class="c1"># our simple straight line</span>
    <span class="n">sigma2</span> <span class="o">=</span> <span class="n">y_err</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">model</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">log_f</span><span class="p">)</span>
    <span class="n">ln_like</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">model</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">sigma2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">sigma2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">ln_like</span>
</pre></div>
</div>
</div>
</div>
<p>If we drew samples from the likelihood rather than the posterior what would we be doing?</p>
</section>
</section>
<section id="the-prior">
<h3>The prior<a class="headerlink" href="#the-prior" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>What does this function below do?</p>
<ul>
<li><p>Discuss it with each other.</p></li>
</ul>
</li>
<li><p>What are the priors we are setting on our parameters?</p>
<ul>
<li><p>Are they reasonable?</p></li>
</ul>
</li>
<li><p>Add comments to the function so that you can remember this later!</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">log_prior</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">log_f</span> <span class="o">=</span> <span class="n">theta</span>
    <span class="k">if</span> <span class="o">-</span><span class="mf">5.0</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="ow">and</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mf">10.0</span> <span class="ow">and</span> <span class="o">-</span><span class="mf">10.0</span> <span class="o">&lt;</span> <span class="n">log_f</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-evidence">
<h3>The evidence<a class="headerlink" href="#the-evidence" title="Permalink to this headline">#</a></h3>
<p>We shall ignore the evidence - it is not necessary here - if you don’t remember why, go back and read the part about Bayes theorem!</p>
</section>
<section id="the-posterior">
<h3>The posterior<a class="headerlink" href="#the-posterior" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">log_probability</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="p">):</span>
    <span class="n">lp</span> <span class="o">=</span> <span class="n">log_prior</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">lp</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="k">return</span> <span class="n">lp</span> <span class="o">+</span> <span class="n">log_likelihood</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Why have we used logs above? (hint, try doing <code class="docutils literal notranslate"><span class="pre">np.exp(1000)</span></code> and <code class="docutils literal notranslate"><span class="pre">np.exp(-1000)</span></code>) What does this function do?</p>
<p>Now we are ready to write our MH algorithm and fit stuff with our MCMC!</p>
</section>
</section>
<section id="recipe-for-mcmc-using-metropolis-hastings-algorithm">
<h2>Recipe for MCMC using metropolis hastings algorithm<a class="headerlink" href="#recipe-for-mcmc-using-metropolis-hastings-algorithm" title="Permalink to this headline">#</a></h2>
<p>From the lecture:</p>
<ol class="simple">
<li><p>Choose some random values for the parameters</p></li>
<li><p>Determine the posterior at these values</p></li>
<li><p>Propose a new step at some new values</p></li>
<li><p>Determine the posterior at these new values</p></li>
<li><p>Compare the two (divide them)</p></li>
<li><p>Generate a random number and compare this to the ratio of the posteriors to decide if you move or stay</p></li>
</ol>
<section id="id1">
<h3>EXERCISE<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>Write a few functions which will perform the MH algorithm</p>
<p>(you should understand and comment the code)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defines the next sample in the chain</span>
<span class="k">def</span> <span class="nf">transition_model</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">theta_new</span>

<span class="c1"># Defines whether to accept or reject the new sample</span>
<span class="k">def</span> <span class="nf">acceptance</span><span class="p">(</span><span class="n">logl</span><span class="p">,</span> <span class="n">logl_new</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">accept</span>


<span class="k">def</span> <span class="nf">metropolis_hastings</span><span class="p">(</span><span class="n">log_probability</span><span class="p">,</span> <span class="n">transition_model</span><span class="p">,</span> <span class="n">param_init</span><span class="p">,</span><span class="n">iterations</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">yerr</span><span class="p">,</span><span class="n">acceptance_rule</span><span class="p">):</span>
    <span class="c1"># log_probability: posterior calculation</span>
    <span class="c1"># transition_model(x): gaussian proposal</span>
    <span class="c1"># param_init: a starting sample</span>
    <span class="c1"># iterations: number of accepted to generated</span>
    <span class="c1"># x,y,yerr: the data that we wish to model</span>
    <span class="c1"># acceptance_rule(theta_prob,theta_prob_new): decides whether to accept or reject the new sample</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">param_init</span>
    <span class="n">accepted</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Can you fill me in?</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">accepted</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="fitting-the-data">
<h2>Fitting the data<a class="headerlink" href="#fitting-the-data" title="Permalink to this headline">#</a></h2>
<p>Using some initial starting parameters which are not the correct answer so that we can see it works!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m_init</span><span class="o">=</span><span class="n">m_true</span> <span class="o">-</span> <span class="n">m_true</span><span class="o">/</span><span class="mf">1.2</span>
<span class="n">b_init</span><span class="o">=</span><span class="n">b_true</span> <span class="o">-</span> <span class="n">b_true</span><span class="o">/</span><span class="mf">1.4</span>
<span class="n">f_init</span><span class="o">=</span><span class="n">f_true</span> <span class="o">-</span> <span class="n">f_true</span><span class="o">/</span><span class="mf">1.1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m_true</span><span class="p">,</span><span class="n">b_true</span><span class="p">,</span><span class="n">f_true</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f_true</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m_init</span><span class="p">,</span><span class="n">b_init</span><span class="p">,</span><span class="n">f_init</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f_init</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.9 4.0 0.9 -0.045757490560675115
-0.15000000000000002 1.1428571428571428 0.0818181818181819 -1.0871501757188997
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta_init</span> <span class="o">=</span> <span class="p">[</span><span class="n">m_init</span><span class="p">,</span><span class="n">b_init</span><span class="p">,</span><span class="n">f_init</span><span class="p">]</span>

<span class="n">accepted</span> <span class="o">=</span> <span class="n">metropolis_hastings</span><span class="p">(</span>
    <span class="n">log_probability</span><span class="p">,</span>
    <span class="n">transition_model</span><span class="p">,</span>
    <span class="n">theta_init</span><span class="p">,</span>
    <span class="mi">200000</span><span class="p">,</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="p">,</span>
    <span class="n">acceptance</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h3>Exercise<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<p>Below is some code which will visualise the results as the chain moves along for parameter b:</p>
<ul class="simple">
<li><p>Plot it also for parameters a and f</p></li>
<li><p>What do you notice about the beginning of the chain?</p></li>
<li><p>Would you include all the samples when quoting your results for the best fit and the 1 <span class="math notranslate nohighlight">\(\sigma\)</span> limits on the parameters?</p>
<ul>
<li><p>Try varying the number of samples plotted in each panel</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">parameter</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span>
<span class="n">dimension</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">accepted</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_samples</span><span class="p">,</span><span class="n">dimension</span><span class="p">],</span> <span class="s1">&#39;b.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Accepted&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Iteration&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MCMC sampling for $</span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s2">$ with Metropolis-Hastings. First </span><span class="si">{</span><span class="n">n_samples</span><span class="si">}</span><span class="s2"> samples are shown.&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">show_final_samples</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">initial_sample</span> <span class="o">=</span> <span class="n">accepted</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">show_final_samples</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">show_final_samples</span><span class="p">)</span> <span class="o">+</span> <span class="n">initial_sample</span><span class="p">,</span> <span class="n">accepted</span><span class="p">[</span><span class="n">initial_sample</span><span class="p">:,</span><span class="n">dimension</span><span class="p">],</span> <span class="s1">&#39;b.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Accepted&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Iteration&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;parameter b&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MCMC sampling for $b$ with Metropolis-Hastings, the last </span><span class="si">{</span><span class="n">show_final_samples</span><span class="si">}</span><span class="s2"> samples are shown.&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">IndexError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Input</span> <span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">dimension</span> <span class="o">=</span> <span class="mi">1</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">n_samples</span> <span class="o">=</span> <span class="mi">10</span>
<span class="ne">----&gt; </span><span class="mi">8</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">accepted</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_samples</span><span class="p">,</span><span class="n">dimension</span><span class="p">],</span> <span class="s1">&#39;b.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Accepted&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Iteration&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="ne">IndexError</span>: too many indices for array: array is 1-dimensional, but 2 were indexed
</pre></div>
</div>
<img alt="../_images/CompPhys_Lect11a_2_NoisyDataFittingRevisited_25_1.png" src="../_images/CompPhys_Lect11a_2_NoisyDataFittingRevisited_25_1.png" />
</div>
</div>
<p>Let’s use a corner plot to explore our results</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is the number of samples to discard at the start of the MCMC</span>
<span class="n">samples_start</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">mh_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">accepted</span><span class="p">[</span><span class="n">samples_start</span><span class="p">:,</span><span class="mi">0</span><span class="p">],</span><span class="n">accepted</span><span class="p">[</span><span class="n">samples_start</span><span class="p">:,</span><span class="mi">1</span><span class="p">],</span><span class="n">accepted</span><span class="p">[</span><span class="n">samples_start</span><span class="p">:,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;log(f)&quot;</span><span class="p">]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">corner</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">mh_samples</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">truths</span><span class="o">=</span><span class="p">[</span><span class="n">m_true</span><span class="p">,</span><span class="n">b_true</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">f_true</span><span class="p">)],</span> <span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.84</span><span class="p">],</span> <span class="n">levels</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">),),</span> <span class="n">show_titles</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">},</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">IndexError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Input</span> <span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># This is the number of samples to discard at the start of the MCMC</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">samples_start</span> <span class="o">=</span> <span class="mi">0</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">mh_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">accepted</span><span class="p">[</span><span class="n">samples_start</span><span class="p">:,</span><span class="mi">0</span><span class="p">],</span><span class="n">accepted</span><span class="p">[</span><span class="n">samples_start</span><span class="p">:,</span><span class="mi">1</span><span class="p">],</span><span class="n">accepted</span><span class="p">[</span><span class="n">samples_start</span><span class="p">:,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;log(f)&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">corner</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">mh_samples</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">truths</span><span class="o">=</span><span class="p">[</span><span class="n">m_true</span><span class="p">,</span><span class="n">b_true</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">f_true</span><span class="p">)],</span> <span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.84</span><span class="p">],</span> <span class="n">levels</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">),),</span> <span class="n">show_titles</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">},</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="ne">IndexError</span>: too many indices for array: array is 1-dimensional, but 2 were indexed
</pre></div>
</div>
</div>
</div>
<p>Another way to visualise this would be to plot samples from your distribution of parameters over the top of your data. For example see the code below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># So it&#39;s not too much on the plot, we will only plot 100 lines:</span>
<span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mh_samples</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">inds</span><span class="p">:</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">mh_samples</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vander</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">sample</span><span class="p">[:</span><span class="mi">2</span><span class="p">]),</span> <span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="c1"># look up the vander function and see what it is doing here</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">yerr</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.k&quot;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">m_true</span> <span class="o">*</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">b_true</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;truth&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;samples&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Input</span> <span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># So it&#39;s not too much on the plot, we will only plot 100 lines:</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mh_samples</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">inds</span><span class="p">:</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">sample</span> <span class="o">=</span> <span class="n">mh_samples</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>

<span class="ne">NameError</span>: name &#39;mh_samples&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "icg-gravwaves/U24568_Computational_Physics",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./11a"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="CompPhys_Lect11a_1_TheGoldfishBowl.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">The Goldfish Bowl</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../11b/overview.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lecture 11b: Using Cython to get the speed of C in Python</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Becky Canning, Ian Harry and Andrew Lundgren<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>